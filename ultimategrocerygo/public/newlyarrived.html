<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>GroceryGo | Store</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700;900&display=swap" rel="stylesheet">
<style>
:root{
  --primary-color:#DC143C;
  --secondary-color:#003893;
  --highlight-color:#FFD700;
  --bg-color:#f8f9fa;
  --text-color:#222;
  --border-color:#ddd;
  --nepali-blue:#003893;
}
*{box-sizing:border-box}
body{font-family:'Poppins',sans-serif;margin:0;background:var(--bg-color);color:var(--text-color);line-height:1.6}

/* Header / Logo / Nav */
header{
  background:linear-gradient(to right,var(--primary-color),var(--secondary-color));
  color:#fff;
  padding:15px 10px 5px 10px;
  text-align:center;
  position:sticky;
  top:0;
  z-index:1000;
}
header h1{
  margin:0 0 5px 0;
  font-size:30px;
  font-weight:900;
  display:flex;
  justify-content:center;
  align-items:center;
  height:60px;
  letter-spacing:-2px;
}
.logo-container{display:flex;align-items:center;position:relative;padding-left:10px}
.logo-trolley-g{font-size:55px;color:white;font-weight:900;line-height:1;position:relative;padding-right:2px;text-shadow:1px 1px 0 var(--primary-color),2px 2px 2px rgba(0,0,0,0.5)}
.logo-grocery-text{position:absolute;top:-4px;left:10px;font-size:14px;font-weight:700;color:#FF8C00;letter-spacing:0.5px;white-space:nowrap;text-shadow:0 0 1px rgba(0,0,0,0.4);z-index:10;transform:rotate(-5deg);padding:2px 4px;background:rgba(255,255,255,0.1);border-radius:3px}
.logo-o{font-size:55px;color:white;font-weight:900;line-height:1;text-shadow:1px 1px 0 var(--primary-color),2px 2px 2px rgba(0,0,0,0.5);transform:translateX(-5px) rotate(2deg);position:relative;z-index:5}
nav{margin-top:5px}
nav a{color:white;text-decoration:none;margin:0 10px;font-weight:600;font-size:14px;padding:5px 0;display:inline-block}
nav a:hover{text-decoration:underline}

/* âœ” FIXED HEADER TOOLS 
   Search bar now stretches fully to the trolley icon */
.header-tools{
  display:flex;
  align-items:center;
  width:100%;
  max-width:1200px;
  margin:0 auto;
  padding:5px 10px;
  gap:10px;
}

.search-wrap{
  flex:1 !important;
  display:flex;
  position:relative;
  margin-right:0 !important;
  max-width:none !important;
}

#headerSearch{
  width:100%;
  padding:8px 15px;
  border:none;
  border-radius:6px;
  font-size:16px;
  box-sizing:border-box;
}

#headerSearchSuggestions{
  border:1px solid var(--border-color);
  border-radius:0 0 8px 8px;
  max-height:300px;
  overflow-y:auto;
  background:white;
  position:absolute;
  width:100%;
  display:none;
  z-index:120;
  color:var(--text-color);
  box-shadow:0 4px 6px rgba(0,0,0,0.12);
  top:100%;
}
#headerSearchSuggestions div{padding:8px 12px;cursor:pointer}
#headerSearchSuggestions div:hover{background:var(--highlight-color);color:#000}

#trolleyIcon{
  cursor:pointer;
  font-size:18px;
  font-weight:700;
  display:flex;
  align-items:center;
  padding:5px 10px;
  border:2px solid var(--highlight-color);
  border-radius:6px;
  background:rgba(255,255,255,0.08);
  transition:background 0.2s;
  white-space:nowrap;
}
#trolleyIcon:hover{background:rgba(255,255,255,0.14)}
#trolleyCount{
  background:var(--highlight-color);
  color:var(--text-color);
  padding:1px 6px;
  border-radius:50%;
  margin-left:8px;
  font-size:14px;
  font-weight:900;
}

/* Banner */
.banner{background:teal;color:white;padding:10px 0;text-align:center;font-weight:700;font-size:16px;position:relative;overflow:hidden;z-index:999;height:36px}
.banner-content{display:flex;justify-content:center;align-items:center;white-space:nowrap;height:100%}
.banner-text{display:inline-block;padding-right:12px}
.banner-add-btn{background:var(--highlight-color);color:var(--text-color);border:none;padding:3px 8px;border-radius:4px;font-size:0.9em;font-weight:700;cursor:pointer;margin-left:10px}
.banner-add-btn:hover{background:#ffc300}

/* Container + categories */
.container{width:95%;max-width:1200px;margin:20px auto;padding:10px}
#horizontal-categories-container{overflow-x:auto;white-space:nowrap;padding:10px 0;border-bottom:1px solid var(--border-color);margin-top:-10px}
.category-pill-btn{padding:8px 15px;margin-right:8px;border:1px solid var(--secondary-color);border-radius:20px;background:white;color:var(--secondary-color);cursor:pointer;font-weight:600;display:inline-block;transition:all 0.15s}
.category-pill-btn:hover{background:#e8f7ff}
.category-pill-btn.active{background:var(--nepali-blue);color:white;border-color:var(--nepali-blue)}

/* Grids */
#productGrid, #popularGrid{display:grid;grid-template-columns:repeat(auto-fill,minmax(220px,1fr));gap:20px;margin-top:20px}
.product-card{background:white;padding:15px;border-radius:8px;box-shadow:0 4px 8px rgba(0,0,0,0.06);text-align:center;position:relative;overflow:hidden;display:flex;flex-direction:column;justify-content:space-between;min-height:420px}
.product-image-container{height:150px;width:100%;margin-bottom:10px;display:flex;justify-content:center;align-items:center}
.product-card img{max-width:100%;max-height:100%;object-fit:contain;border-radius:6px}
.product-info{flex-grow:1;text-align:left;margin-bottom:10px}
.product-name{font-weight:600;margin:5px 0 0;font-size:1.05em;min-height:44px}
.product-brand{color:#555;font-size:0.9em;margin-bottom:5px;display:block}
.product-price{font-size:1.15em;font-weight:700;color:var(--primary-color);margin-bottom:5px;display:block}
.add-to-cart-btn{width:100%;margin-top:8px;padding:10px 12px;border-radius:8px;font-size:1.05em;background:var(--primary-color);color:#fff;border:none;cursor:pointer}

/* modal/toast */
#confirmAddModal{display:none;position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);background:white;padding:18px;border-radius:8px;box-shadow:0 8px 30px rgba(0,0,0,0.18);z-index:150;width:92%;max-width:420px;text-align:center}
#confirmAddModal h3{margin:6px 0}
.variant-selection{display:flex;flex-wrap:wrap;gap:8px;justify-content:center;margin-top:8px}
.grid-variant-btn{padding:6px 10px;border-radius:6px;border:1px solid #ccc;background:#f6f6f6;cursor:pointer}
.grid-variant-btn.selected{background:var(--nepali-blue);color:white;border-color:var(--nepali-blue)}
#confirmModalAddBtn{margin-top:12px;padding:10px 14px;border-radius:8px;border:none;background:var(--primary-color);color:#fff;cursor:pointer}

/* toast */
#centerToast{position:fixed;top:18px;left:50%;transform:translateX(-50%);background:var(--nepali-blue);color:white;padding:10px 16px;border-radius:6px;z-index:999;display:none;font-weight:700}

/* small screens */
@media(max-width:480px){
  header h1{font-size:22px}
  .product-name{font-size:1em}
}
footer{
  background: var(--nepali-blue);
  color: white;
  text-align: center;
  padding: 15px 0;
  font-size: 14px;
  margin-top: 40px;
}
</style>
</head>
<body>

<header>
  <h1>
    <div class="logo-container">
      <span class="logo-trolley-g">G<span class="logo-grocery-text">Grocery</span></span>
      <span class="logo-o">o</span>
    </div>
  </h1>

 <nav>
    <a href="index.html">HOME</a>
    <a href="store.html">STORE</a>
    <a href="about.html">ABOUT US</a>
    <a href="contact.html">CONTACT</a>
  </nav>


  <div class="header-tools">
    <div class="search-wrap" style="flex:1;min-width:220px;">
      <input id="headerSearch" placeholder="ðŸ” Search (e.g., 'rice', 'MDH')..." autocomplete="off">
      <div id="headerSearchSuggestions" role="listbox"></div>
    </div>

    <div id="trolleyIcon" onclick="window.location.href='trolley.html'">
      ðŸ›’ <span id="trolleyCount">0</span>
    </div>
  </div>

  <div class="banner">
    <div id="dynamicBannerContent" class="banner-content">
      <span id="dynamicBannerText" class="banner-text">Welcome to GroceryGo! New stock just arrived!</span>
      <button class="banner-add-btn" id="bannerAddBtn">Add</button>
    </div>
  </div>
</header>


<div class="container">
  <h2>ðŸ†• Newly Arrived Products</h2>
  <div id="productGrid"></div>
</div>


<footer>Â© 2025 GroceryGo. All rights reserved.</footer>
<div id="centerToast"></div>
<div id="confirmAddModal"></div>

<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<script>
const SUPABASE_URL = "https://gikdqaxdqfmzdvolkxbn.supabase.co";
const SUPABASE_ANON_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imdpa2RxYXhkcWZtemR2b2xreGJuIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjIyOTQwNDIsImV4cCI6MjA3Nzg3MDA0Mn0.pJ-9KfCxV7YT5loiURW14xRmf72s1EZRFRh4iKGnQis";
const supabase = supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

let products=[],trolley=[],bannerIndex=0;

async function fetchProducts(){
  const {data,error} = await supabase.from('products').select('*').order('created_at',{ascending:false});
  if(error){ console.error(error); return; }
  products=data;
  renderProducts();
  renderFeaturedBanner();
}

function renderProducts(){
  const grid = document.getElementById('productGrid');
  grid.innerHTML='';
  products.forEach(p=>{
    const card = document.createElement('div');
    card.className='product-card';
    card.innerHTML=`
      <div class="product-image-container"><img src="${p.image}" alt="${p.name}"></div>
      <div class="product-info">
        <span class="product-brand">${p.brand}</span>
        <span class="product-name">${p.name}</span>
        <span class="product-price">$${p.price}</span>
      </div>
      <button class="add-to-cart-btn" onclick="addToTrolley(${p.id})">Add to Cart</button>
    `;
    grid.appendChild(card);
  });
}

function renderFeaturedBanner(){
  const banner=document.getElementById('dynamicBannerContent');
  if(products.length===0) return;
  banner.innerHTML='';
  const p=products[bannerIndex%products.length];
  const span=document.createElement('span');
  span.className='banner-text';
  span.innerHTML=`${p.name} - $${p.price} <button class="banner-add-btn" onclick="addToTrolley(${p.id})">Add</button>`;
  banner.appendChild(span);
  bannerIndex++;
}
setInterval(renderFeaturedBanner,4000);

function addToTrolley(id,qty=1){
  const p=products.find(x=>x.id===id);
  if(!p) return;
  const existing=trolley.find(i=>i.id===id);
  if(!existing) trolley.push({id:p.id,name:p.name,quantity:qty});
  else existing.quantity+=qty;
  document.getElementById('trolleyCount').textContent=trolley.length;
  showCenterToast(`${p.name} added to trolley!`);
  supabase.from('trolley').insert([{product_id:id}]);
}

function showCenterToast(msg){
  const toast=document.getElementById('centerToast');
  toast.textContent=msg;
  toast.style.display='block';
  setTimeout(()=>{ toast.style.display='none'; },1500);
}

document.addEventListener('DOMContentLoaded',fetchProducts);